
\documentclass[a4paper]{article}
\usepackage{geometry}
\geometry{paperwidth=\maxdimen,paperheight=\maxdimen,margin=1cm}

\usepackage[fleqn]{amsmath} %for multiple line equations
\usepackage[active,tightpage,displaymath]{preview}
\usepackage{bm}
\newcommand{\vect}[1]{\boldsymbol{\mathbf{#1}}}

\begin{document}
\pagenumbering{gobble}
 \begin{footnotesize}
 \setcounter{MaxMatrixCols}{200}
  \begin{align*}
  \textrm{Subject parameter distribution: }
             &\underbrace{\begin{bmatrix}
\text{T0m\_eta1}_i\\ 
\text{slope}_i
\end{bmatrix} 
            }_{\vect{\phi}(i)} \sim\textrm{tform}\left\{ \mathrm{N} \left(
              \begin{bmatrix}
\text{raw\_T0m\_eta1}\\ 
\text{raw\_slope}
\end{bmatrix}, \begin{bmatrix}
\text{raw\_PCov\_1\_1} & \text{raw\_PCov\_2\_1}\\ 
\text{raw\_PCov\_2\_1} & \text{raw\_PCov\_2\_2}
\end{bmatrix} \right) \right\} \\\textrm{Initial latent states: }
  &\underbrace{\begin{bmatrix}
\text{eta1}
\end{bmatrix} 
    \big{(}t_0\big{)}}_{\vect{\eta} (t_0)}	\sim \mathrm{N} \left(
              \underbrace{
        \begin{bmatrix}
\text{T0m\_eta1}
\end{bmatrix}
      }_{\underbrace{\vect{}}_\textrm{T0MEANS}},
      \underbrace{covsdcor \left\{
        \begin{bmatrix}
\text{Pcorsqrt\_1\_1}
\end{bmatrix}\right\}
      }_{\underbrace{\vect{Q^{*}}_{t0}}_\textrm{T0VAR}}
      \right) \\
      \textrm{Deterministic change:}
  &\underbrace{\mathrm{d}
    \begin{bmatrix}
\text{eta1}
\end{bmatrix} 
    \big{(}t\big{)}}_{\mathrm{d} \vect{\eta} (t)}	=  \left(
      \underbrace{
        \begin{bmatrix}
0
\end{bmatrix}
      }_{\underbrace{\vect{A}}_\textrm{DRIFT}} \underbrace{
        \begin{bmatrix}
\text{eta1}
\end{bmatrix} 
        \big{(}t\big{)}
      }_{\vect{\eta} (t)}	+ \underbrace{
        \begin{bmatrix}
\text{slope}
\end{bmatrix}
      }_{\underbrace{\vect{b}}_\textrm{CINT}}\right) \mathrm{d}t \quad + \nonumber \\ \\
    \textrm{Random change: }
    & \qquad \qquad \quad \underbrace{cholsdcor\left\{
      \begin{bmatrix}
0
\end{bmatrix}\right\}
    }_{\underbrace{\vect{G}}_\textrm{DIFFUSION}}
    \underbrace{\mathrm{d}
      \begin{bmatrix}
W_{1}
\end{bmatrix} 
      (t)}_{\mathrm{d} \vect{W}(t)} \\ \\
              \textrm{Observations: }
&\underbrace{
      \begin{bmatrix}
\text{y1}
\end{bmatrix}  
      (t)}_{\vect{Y}(t)} = 
        \underbrace{
          \begin{bmatrix}
1
\end{bmatrix} 
        }_{\underbrace{\vect{\Lambda}}_\textrm{LAMBDA}} \underbrace{
          \begin{bmatrix}
\text{eta1}
\end{bmatrix} 
          (t)}_{\vect{\eta}(t)} +
        \underbrace{
          \begin{bmatrix}
0
\end{bmatrix} 
        }_{\underbrace{\vect{\tau}}_\textrm{MANIFESTMEANS}} + 
              \underbrace{
                \begin{bmatrix}
\text{log1p(exp(errorsd\_intercept + errorsd\_byeta1 * eta1))}
\end{bmatrix}  
              }_{\underbrace{\vect{\Theta}}_\textrm{MANIFESTVAR}}
              \underbrace{
          \begin{bmatrix}
\epsilon_{1}
\end{bmatrix} 
          (t)}_{\vect{\epsilon}(t)} \\ \\
                \textrm{Latent noise per time step : }
          &\Delta \big[W_{j \in [1,1]}\big](t-u)   \sim  \mathrm{N}(0,t-u) \quad
              \textrm{Observation noise: }
            \begin{bmatrix}
\epsilon_{j \in [1,1]}
\end{bmatrix} 
            (t) \sim  \mathrm{N}(0,1) \\ \\
&cholsdcor\textrm{ converts lower tri matrix of std dev and unconstrained correlation to Cholesky factor covariance.} \\
&covsdcor =\textrm{ transposed cross product of cholsdcor, to give covariance.} \\
&\textrm{See Driver \& Voelkle (2018) p11.}
      \end{align*}
      \end{footnotesize}
      \end{document}
